{% extends "layout.html" %}
{% load crispy_forms_tags %}
{% block title %}<title>Two Factor Authentication</title>{% endblock %}
{% block content %}

    <!-- navbar -->
    <nav class="navbar navbar-dark bg-dark navbar-expand-md text-light navbar-nav-scroll fixed-top py-4" id="nav">
        <div class="container">
            <p href="" class="navbar-brand"><span class="h3">Educator Dashboard</span></p>
            <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                id="navbar-toggler">
                <i class="fas fa-angle-down" id="toggle-button"></i>
            </button>
            <div class="navbar-collapse collapse" id="navbar">
                <ul class="navbar-nav ms-auto">
                    {% if request.user.user_profile_educator %}
                        <li class="nav-item"><a href="{% url 'educator_dashboard' %}" class="nav-link text-light lead"><span
                            id="nav-link">Dashboard</span></a></li> 
                    {% elif request.user.user_profile_student %}
                        <li class="nav-item"><a href="{% url 'student_dashboard' %}" class="nav-link text-light lead"><span
                        id="nav-link">Dashboard</span></a></li>
                    {% endif %}
                
                    <li class="nav-item"><a href="{% url 'account:profile'  %}" class="nav-link text-light lead"><span
                        id="nav-link">Profile</span></a></li>   
                </ul>
            </div>
        </div>
    </nav>
  <!-- end navbar -->

    <div class="container py-5 mt-5">
        <h1 class="mb-5 text-center py-5">Two Factor Authentication</h1>
        <div class="card mt-5">
            <div class="card-body">
                <div class="row d-flex align-items-center d-flex justify-content-center">
                    
                    {% if request.user.authenticator_enable == False %}
                        <p class="text-center fw-bold">Your Two Factor Autentication currently disabled</p>
                        <p class="text-center fw-bold">Download google authenticator from play store in your mobile.</p>
                        <hr>
                        <p class="text-center fw-bold">If you are using PC</p>
                        <p>1. Scan the qrcode using google authenticator in mobile.</p>
                        <p>2. Enter the six digit code generated by google
                            authenticator below, to enable Two Factor Authentication.</p>
                        <hr>
                        <p class="text-center fw-bold">If you are using mobile</p>
                        <p>1. Open google authenticator in your mobile and choose 'Enter a setup key' option. </p>
                        <p>2. Enter your account name as your wish.</p>
                        <p>3. Enter your secret authentication key shown below.</p>
                        <p>4. NOTE: Choose TIME BASED authentication.</p>
                        <p>5. After finishing above steps, enter the six digit code generated by google
                            authenticator below, to enable Two Factor Authentication.</p>
                        <hr>

                        <img src="{{request.user.authenticator.authenticator_qrcode.url}}" alt="" class="img-fluid col-lg-5">
                        <p class="text-center fw-bold h5">Secret authentication key: {{request.user.authenticator}}</p>
                    {% else %}
                        <p class="text-center fw-bold">Enter your six digit code to disable Two factor authentication.</p>
                        <p class="text-center fw-bold"> Currently Two factor authentication enabled.</p>
                    
                    {% endif %}
                    <div class="col-lg-5">
                        <form method="POST" action="{% url 'account:two_factor' %}" class="mt-4">

                            {% csrf_token %}
                            {{ form|crispy}}
        
                            <button class="btn btn-primary d-grid gap-2 col-6 mx-auto fw-bold mt-5" type="submit">submit</button>
                        </form>
                    </div>  
                </div>
            </div>
        </div>
    </div>

{% endblock %}